<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Actsafe OHS Pathway Navigator</title>
    <!-- Load Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- 
      CRITICAL: Inject the custom Actsafe color configuration into Tailwind.
      This ensures 'actsafe-blue' and 'actsafe-yellow' classes work.
    -->
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              'actsafe-blue': '#0A3F5C',
              'actsafe-yellow': '#FDB913',
              'actsafe-yellow-dark': '#E0A300',
            },
            fontFamily: {
              sans: ['Inter', 'sans-serif'],
            },
          },
        },
      };
    </script>
    
    <!-- 
      Lucide Icons are loaded here as global SVG functions 
      for use in the JavaScript rendering logic.
    -->
    <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body class="bg-gray-50 font-sans">

    <!-- Root Container -->
    <div class="min-h-screen p-4 sm:p-8">
        <div class="max-w-4xl mx-auto">
            
            <!-- Header and Title Card -->
            <div class="bg-white p-6 sm:p-8 rounded-2xl shadow-xl border-t-8 border-actsafe-yellow mb-8">
                <h1 class="text-3xl sm:text-4xl font-extrabold text-actsafe-blue mb-2">
                    Your Essential Industry Safety Training Guide
                </h1>
                <p class="text-gray-600 mb-4 text-lg">
                    We help you find the **mandatory** and **recommended** training you need to work safely in B.C.'s motion picture, performing arts, and live event industries.
                </p>
                <div class="flex flex-wrap gap-2 text-sm text-gray-500">
                    <span class="px-3 py-1 bg-actsafe-blue text-white rounded-full">Based on B.C. Safety Standards</span>
                    <span class="px-3 py-1 bg-gray-200 rounded-full">Free Resource from Actsafe</span>
                </div>
            </div>

            <!-- Step 1: Industry Selection Container -->
            <div id="industry-selection-container" class="bg-white p-6 sm:p-8 rounded-2xl shadow-lg mb-8">
                <h2 class="text-2xl font-bold text-actsafe-blue mb-4">
                    1. Select Your Industry
                </h2>
                <!-- Industry Buttons rendered here by JS -->
                <div id="industry-buttons-row" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <!-- Dynamic content -->
                </div>
            </div>

            <!-- Step 2: Role Selection Container (Hidden until industry selected) -->
            <div id="role-selection-card" class="bg-white p-6 sm:p-8 rounded-2xl shadow-lg mb-8 hidden">
                <div id="role-selector-content">
                    <!-- Role Dropdown rendered here by JS -->
                </div>
            </div>

            <!-- Step 3: Results Display Container (Hidden until role selected) -->
            <div id="results-display-card" class="bg-white p-6 sm:p-8 rounded-2xl shadow-lg mb-8 hidden">
                <h2 class="text-2xl font-bold text-actsafe-blue mb-6">
                    3. Your Personalized Training Checklist
                </h2>
                <!-- Training Cards rendered here by JS -->
                <div id="training-checklist-content" class="space-y-6">
                    <!-- Dynamic content -->
                </div>

                <!-- Disclaimer -->
                <div class="mt-8 p-4 bg-gray-100 border border-gray-300 rounded-lg text-sm text-gray-700">
                    <p class="font-semibold mb-1">Important Disclaimer</p>
                    <p>
                        This training pathway serves as a general guide based on common industry practices and union requirements. 
                        It is **not** an official legal interpretation of the Workers Compensation Act (WCA) or the OHS Regulation. 
                        For clarification on compliance or best practices specific to your site, please 
                        <a href="https://actsafe.ca/contact-us/" target="_blank" rel="noopener noreferrer" class="font-bold underline ml-1 text-actsafe-blue hover:text-actsafe-yellow-dark">contact Actsafe directly</a> for expert OHS advice.
                    </p>
                </div>

                <!-- CTA Integration - Consulting Lead Generation -->
                <div class="mt-8 text-center p-6 bg-actsafe-blue rounded-xl text-white">
                    <h3 class="text-xl font-bold mb-2">Need Specialized Safety Guidance?</h3>
                    <p class="mb-4 text-sm opacity-90">
                        Our OHS consultants can help you discuss site-specific requirements or specialized crew needs for free.
                    </p>
                    <a 
                        href="https://actsafe.ca/contact-us/"
                        target="_blank" 
                        rel="noopener noreferrer"
                        class="bg-actsafe-yellow text-actsafe-blue font-bold py-2 px-6 rounded-full shadow-lg hover:bg-actsafe-yellow-dark transition duration-300 transform hover:scale-105 inline-block"
                    >
                        Contact Us
                    </a>
                </div>
            </div>

            <!-- Initial Prompt -->
            <div id="initial-prompt" class="bg-white p-8 rounded-2xl shadow-lg border-l-4 border-gray-400">
                <p class="text-gray-500 text-lg">
                    Get started by selecting your industry above to unlock your personalized safety pathway.
                </p>
            </div>

        </div>
    </div>

    <script>
        // --- VANILLA JAVASCRIPT LOGIC ---
        
        // --- CONFIG & DATA ---
        const ACTSAFE_COURSE_BASE_URL = 'https://actsafe.ca/courses-workshops/';
        const ACTSAFE_CONSULTATION_URL = 'https://actsafe.ca/contact-us/';
        const WHMIS_URL = 'https://actsafe.ca/courses-workshops/whmis-2025/';
        const LPEC_URL = 'https://actsafe.ca/courses-workshops/live-performance-electrical-certification/';
        const TCP_URL = 'https://www.bccsa.ca/tcp_program.php'; // BC Construction Safety Alliance is the provider
        const FIREARMS_URL = 'https://actsafe.ca/topic/weapons/props-firearms-safety-course/';
        const PYRO_URL = 'https://actsafe.ca/topic/open-flames/pyrotechnic-special-effects/';
        
        const INDUSTRIES = [
            { id: 'mp', name: 'Motion Picture', iconName: 'Briefcase' },
            { id: 'pa', name: 'Performing Arts', iconName: 'Star' },
            { id: 'le', name: 'Live Events', iconName: 'Zap' },
        ];
        
        // --- EXPANDED TRAINING DATA WITH NEW ROLES & CORRECTED SPFX LINKS ---
        const TRAINING_DATA = {
            'mp': {
                'Production Assistant / Entry-Level Crew': [
                    { id: 1, name: 'Motion Picture Safety Awareness', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}motion-picture-safety-awareness/` },
                    { id: 17, name: 'WHMIS', type: 'Mandatory', link: WHMIS_URL }, 
                    { id: 18, name: 'Motion Picture Industry Orientation (MPIO) & Exam', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}motion-picture-industry-orientation-and-exam/` },
                    { id: 4, name: 'Occupational First Aid - Basic', type: 'Recommended', link: `${ACTSAFE_COURSE_BASE_URL}occupational-first-aid-basic/` }, 
                ],
                'Grip / Camera / Lighting Technician (Technical)': [
                    { id: 1, name: 'Motion Picture Safety Awareness', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}motion-picture-safety-awareness/` },
                    { id: 17, name: 'WHMIS', type: 'Mandatory', link: WHMIS_URL }, 
                    { id: 19, name: 'Fall Protection Training', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}fall-protection/` }, 
                    { id: 3, name: 'Aerial & Scissor Lift Training', type: 'Recommended', link: ACTSAFE_CONSULTATION_URL }, 
                ],
                'Head of Department / Supervisor': [
                    { id: 1, name: 'Motion Picture Safety Awareness', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}motion-picture-safety-awareness/` },
                    { id: 17, name: 'WHMIS', type: 'Mandatory', link: WHMIS_URL }, 
                    { id: 20, name: 'Motion Picture Safety for Supervisors', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}motion-picture-safety-for-supervisors/` },
                    { id: 21, name: 'Joint Health & Safety Committee Fundamentals', type: 'Recommended', link: `${ACTSAFE_COURSE_BASE_URL}joint-health-safety-committee-fundamentals/` }, 
                ],
                'Location Manager / Location Scout': [
                    { id: 1, name: 'Motion Picture Safety Awareness', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}motion-picture-safety-awareness/` },
                    { id: 17, name: 'WHMIS', type: 'Mandatory', link: WHMIS_URL },
                    { id: 20, name: 'Motion Picture Safety for Supervisors', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}motion-picture-safety-for-supervisors/` },
                    { id: 32, name: 'Motion Picture Risk Assessment', type: 'Recommended', link: ACTSAFE_CONSULTATION_URL }, // Specialized course
                    { id: 33, name: 'Traffic Control Person (TCP)', type: 'Recommended', link: TCP_URL }, // External provider
                ],
                'Production Manager / Coordinator': [
                    { id: 1, name: 'Motion Picture Safety Awareness', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}motion-picture-safety-awareness/` },
                    { id: 17, name: 'WHMIS', type: 'Mandatory', link: WHMIS_URL },
                    { id: 20, name: 'Motion Picture Safety for Supervisors', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}motion-picture-safety-for-supervisors/` },
                    { id: 29, name: 'Workplace Bullying & Harassment', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}anti-bullying-and-harassment/` },
                    { id: 21, name: 'Joint Health & Safety Committee Fundamentals', type: 'Recommended', link: `${ACTSAFE_COURSE_BASE_URL}joint-health-safety-committee-fundamentals/` },
                    { id: 30, name: 'Ergonomics for Office & Set', type: 'Recommended', link: ACTSAFE_CONSULTATION_URL },
                ],
                'Transportation Department (Driver, Captain)': [
                    { id: 1, name: 'Motion Picture Safety Awareness', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}motion-picture-safety-awareness/` },
                    { id: 20, name: 'Motion Picture Safety for Supervisors', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}motion-picture-safety-for-supervisors/` },
                    { id: 33, name: 'Traffic Control Person (TCP)', type: 'Recommended', link: TCP_URL },
                    { id: 34, name: 'Fatigue Management', type: 'Recommended', link: ACTSAFE_CONSULTATION_URL },
                ],
                'Construction / Painter / Greens': [
                    { id: 1, name: 'Motion Picture Safety Awareness', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}motion-picture-safety-awareness/` },
                    { id: 17, name: 'WHMIS', type: 'Mandatory', link: WHMIS_URL },
                    { id: 19, name: 'Fall Protection Training', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}fall-protection/` },
                    { id: 35, name: 'Power Tool Safety', type: 'Recommended', link: ACTSAFE_CONSULTATION_URL },
                    { id: 36, name: 'Scaffold Safety Awareness', type: 'Recommended', link: ACTSAFE_CONSULTATION_URL },
                ],
                'Costume / Hair / Makeup': [
                    { id: 1, name: 'Motion Picture Safety Awareness', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}motion-picture-safety-awareness/` },
                    { id: 17, name: 'WHMIS', type: 'Mandatory', link: WHMIS_URL },
                    { id: 30, name: 'Ergonomics', type: 'Recommended', link: ACTSAFE_CONSULTATION_URL },
                ],
                'Set Decorator / Props Department': [
                    { id: 1, name: 'Motion Picture Safety Awareness', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}motion-picture-safety-awareness/` },
                    { id: 17, name: 'WHMIS', type: 'Mandatory', link: WHMIS_URL }, 
                    { id: 28, name: 'Fire Safety and Emergency Procedures', type: 'Recommended', link: ACTSAFE_CONSULTATION_URL }, 
                    { id: 31, name: 'Manual Material Handling', type: 'Recommended', link: ACTSAFE_CONSULTATION_URL }, 
                ],
                'Office / Production Staff': [
                    { id: 1, name: 'Motion Picture Safety Awareness', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}motion-picture-safety-awareness/` },
                    { id: 29, name: 'Workplace Bullying & Harassment', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}anti-bullying-and-harassment/` }, 
                    { id: 30, name: 'Ergonomics for Office & Set', type: 'Recommended', link: ACTSAFE_CONSULTATION_URL }, 
                ],
                'Sound Department (Mixer, Boom Op)': [
                    { id: 1, name: 'Motion Picture Safety Awareness', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}motion-picture-safety-awareness/` },
                    { id: 17, name: 'WHMIS', type: 'Recommended', link: WHMIS_URL },
                    { id: 30, name: 'Ergonomics', type: 'Recommended', link: ACTSAFE_CONSULTATION_URL },
                    { id: 37, name: 'Hearing Protection', type: 'Recommended', link: ACTSAFE_CONSULTATION_URL },
                ],
                'Special Effects (SPFX) / Stunts': [
                    { id: 1, name: 'Motion Picture Safety Awareness', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}motion-picture-safety-awareness/` },
                    { id: 17, name: 'WHMIS', type: 'Mandatory', link: WHMIS_URL },
                    { id: 19, name: 'Fall Protection Training', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}fall-protection/` },
                    { id: 38, name: 'Props & Firearms Safety Course', type: 'Recommended', link: FIREARMS_URL }, 
                    { id: 39, name: 'Pyrotechnic Special Effects', type: 'Recommended', link: PYRO_URL }, 
                ],
                'Other (Request OHS Advice)': [
                    { id: 1, name: 'Motion Picture Safety Awareness (Foundation)', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}motion-picture-safety-awareness/` },
                    { id: 16, name: 'Request OHS Consultation for Specialized Role', type: 'Recommended', link: ACTSAFE_CONSULTATION_URL },
                ],
            },
            'pa': {
                'Stage Manager / Venue Crew': [
                    { id: 22, name: 'Performing Arts Safety Awareness', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}performing-arts-safety-awareness/` },
                    { id: 17, name: 'WHMIS', type: 'Mandatory', link: WHMIS_URL }, 
                    { id: 4, name: 'Occupational First Aid - Basic', type: 'Recommended', link: `${ACTSAFE_COURSE_BASE_URL}occupational-first-aid-basic/` }, 
                    { id: 23, name: 'Rigging Safety Fundamentals', type: 'Recommended', link: ACTSAFE_CONSULTATION_URL }, 
                ],
                'Theatre Carpenter / Set Construction': [
                    { id: 22, name: 'Performing Arts Safety Awareness', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}performing-arts-safety-awareness/` },
                    { id: 17, name: 'WHMIS', type: 'Mandatory', link: WHMIS_URL }, 
                    { id: 19, name: 'Fall Protection Training', type: 'Recommended', link: `${ACTSAFE_COURSE_BASE_URL}fall-protection/` }, 
                    { id: 26, name: 'Power Tool Safety (Workshop)', type: 'Recommended', link: ACTSAFE_CONSULTATION_URL }, 
                ],
                'Arts & Venue Supervisor': [
                    { id: 22, name: 'Performing Arts Safety Awareness', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}performing-arts-safety-awareness/` },
                    { id: 17, name: 'WHMIS', type: 'Mandatory', link: WHMIS_URL }, 
                    { id: 24, name: 'Performing Arts Safety for Supervisors', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}performing-arts-safety-for-supervisors/` }, 
                    { id: 21, name: 'Joint Health & Safety Committee Fundamentals', type: 'Recommended', link: `${ACTSAFE_COURSE_BASE_URL}joint-health-safety-committee-fundamentals/` }, 
                ],
                'Performer / Artist (Actor, Dancer, Musician)': [
                    { id: 22, name: 'Performing Arts Safety Awareness', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}performing-arts-safety-awareness/` },
                    { id: 29, name: 'Workplace Bullying & Harassment', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}anti-bullying-and-harassment/` },
                    { id: 30, name: 'Ergonomics for Performers', type: 'Recommended', link: ACTSAFE_CONSULTATION_URL },
                    { id: 37, name: 'Hearing Protection', type: 'Recommended', link: ACTSAFE_CONSULTATION_URL },
                ],
                'Costume / Wardrobe Technician': [
                    { id: 22, name: 'Performing Arts Safety Awareness', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}performing-arts-safety-awareness/` },
                    { id: 17, name: 'WHMIS', type: 'Recommended', link: WHMIS_URL }, 
                    { id: 28, name: 'Fire Safety and Emergency Procedures', type: 'Recommended', link: ACTSAFE_CONSULTATION_URL }, 
                ],
                'Administration / Marketing Staff': [
                    { id: 22, name: 'Performing Arts Safety Awareness', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}performing-arts-safety-awareness/` },
                    { id: 29, name: 'Workplace Bullying & Harassment', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}anti-bullying-and-harassment/` }, 
                    { id: 30, name: 'Ergonomics for Office & Set', type: 'Recommended', link: ACTSAFE_CONSULTATION_URL }, 
                ],
                'Front of House (FOH) Staff (Box Office, Usher)': [
                    { id: 22, name: 'Performing Arts Safety Awareness', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}performing-arts-safety-awareness/` },
                    { id: 4, name: 'Occupational First Aid - Basic', type: 'Recommended', link: `${ACTSAFE_COURSE_BASE_URL}occupational-first-aid-basic/` },
                    { id: 29, name: 'Workplace Bullying & Harassment', type: 'Recommended', link: `${ACTSAFE_COURSE_BASE_URL}anti-bullying-and-harassment/` },
                    { id: 40, name: 'Emergency Evacuation Procedures', type: 'Recommended', link: ACTSAFE_CONSULTATION_URL },
                ],
                'Other (Request OHS Advice)': [
                    // --- THIS IS THE FIXED LINE ---
                    { id: 22, name: 'Performing Arts Safety Awareness (Foundation)', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}performing-arts-safety-awareness/` },
                    { id: 16, name: 'Request OHS Consultation for Specialized Role', type: 'Recommended', link: ACTSAFE_CONSULTATION_URL },
                ],
            },
            'le': {
                'Stagehand / General Crew (Load-in/out)': [
                    { id: 22, name: 'Performing Arts Safety Awareness', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}performing-arts-safety-awareness/` },
                    { id: 17, name: 'WHMIS', type: 'Mandatory', link: WHMIS_URL },
                    { id: 31, name: 'Manual Material Handling', type: 'Recommended', link: ACTSAFE_CONSULTATION_URL },
                    { id: 19, name: 'Fall Protection Training', type: 'Recommended', link: `${ACTSAFE_COURSE_BASE_URL}fall-protection/` },
                ],
                'Stage Rigger / Fly Crew': [
                    { id: 22, name: 'Performing Arts Safety Awareness', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}performing-arts-safety-awareness/` },
                    { id: 17, name: 'WHMIS', type: 'Mandatory', link: WHMIS_URL }, 
                    { id: 19, name: 'Fall Protection Training', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}fall-protection/` }, 
                    { id: 25, name: 'Live Performance Electrical Certification', type: 'Recommended', link: LPEC_URL }, 
                ],
                'Forklift / Aerial Lift Operator': [
                    { id: 22, name: 'Performing Arts Safety Awareness', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}performing-arts-safety-awareness/` },
                    { id: 17, name: 'WHMIS', type: 'Recommended', link: WHMIS_URL }, 
                    { id: 27, name: 'Powered Mobile Equipment (Forklift)', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}forklift/` }, 
                    { id: 3, name: 'Aerial & Scissor Lift Training', type: 'Mandatory', link: ACTSAFE_CONSULTATION_URL }, 
                ],
                'Crowd Safety Supervisor / FOH Manager': [
                    { id: 22, name: 'Performing Arts Safety Awareness', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}performing-arts-safety-awareness/` },
                    { id: 4, name: 'Occupational First Aid - Basic', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}occupational-first-aid-basic/` }, 
                    { id: 9, name: 'Crowd Management Safety (Resource)', type: 'Recommended', link: `https://actsafe.ca/crowd-management/` }, 
                ],
                'Audio Visual Technician': [
                    { id: 22, name: 'Performing Arts Safety Awareness', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}performing-arts-safety-awareness/` },
                    { id: 17, name: 'WHMIS', type: 'Mandatory', link: WHMIS_URL }, 
                    { id: 31, name: 'Manual Material Handling', type: 'Recommended', link: ACTSAFE_CONSULTATION_URL }, 
                    { id: 25, name: 'Live Performance Electrical Certification', type: 'Recommended', link: LPEC_URL }, 
                ],
                'Event Security / Guest Services': [
                    { id: 22, name: 'Performing Arts Safety Awareness', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}performing-arts-safety-awareness/` },
                    { id: 4, name: 'Occupational First Aid - Basic', type: 'Recommended', link: `${ACTSAFE_COURSE_BASE_URL}occupational-first-aid-basic/` },
                    { id: 29, name: 'Workplace Bullying & Harassment', type: 'Recommended', link: `${ACTSAFE_COURSE_BASE_URL}anti-bullying-and-harassment/` },
                    { id: 9, name: 'Crowd Management Safety (Resource)', type: 'Recommended', link: `https://actsafe.ca/crowd-management/` },
                ],
                'Event Planner / Administrator': [
                    { id: 22, name: 'Performing Arts Safety Awareness', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}performing-arts-safety-awareness/` },
                    { id: 29, name: 'Workplace Bullying & Harassment', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}anti-bullying-and-harassment/` }, 
                    { id: 21, name: 'Joint Health & Safety Committee Fundamentals', type: 'Recommended', link: `${ACTSAFE_COURSE_BASE_URL}joint-health-safety-committee-fundamentals/` }, 
                ],
                'Other (Request OHS Advice)': [
                    { id: 22, name: 'Performing Arts Safety Awareness (Foundation)', type: 'Mandatory', link: `${ACTSAFE_COURSE_BASE_URL}performing-arts-safety-awareness/` },
                    { id: 16, name: 'Request OHS Consultation for Specialized Role', type: 'Recommended', link: ACTSAFE_CONSULTATION_URL },
                ],
            },
        };


        // --- STATE VARIABLES ---
        let selectedIndustryId = null;
        let selectedRole = null;
        

        // --- DOM RENDER FUNCTIONS ---
        
        // Helper to get the Lucide SVG HTML string 
        const getIconSvg = (iconName, classes) => {
            if (typeof window.lucide === 'undefined' || typeof window.lucide[iconName] !== 'function') {
                return ''; 
            }
            const iconFunc = window.lucide[iconName];
            const svgString = iconFunc();
            return svgString.replace(/<svg/, `<svg class="${classes}"`);
        };

        // Renders the Industry selection buttons (Step 1)
        const renderIndustrySelectors = () => {
            const container = document.getElementById('industry-buttons-row');
            if (!container) return;
            container.innerHTML = INDUSTRIES.map(industry => {
                const isSelected = selectedIndustryId === industry.id;
                const baseClasses = "p-5 rounded-xl border-2 transition-all duration-300 transform hover:scale-[1.03] shadow-md cursor-pointer";
                const selectedClasses = 'border-actsafe-yellow bg-actsafe-blue text-white ring-4 ring-actsafe-yellow';
                const unselectedClasses = 'border-gray-200 bg-gray-50 text-gray-800 hover:bg-gray-100';
                
                return `
                    <button
                        onclick="handleIndustryChange('${industry.id}')"
                        class="${baseClasses} ${isSelected ? selectedClasses : unselectedClasses}"
                    >
                        ${getIconSvg(industry.iconName, 'w-6 h-6 mb-2 mx-auto')}
                        <span class="font-semibold text-lg">${industry.name}</span>
                    </button>
                `;
            }).join('');
        };

        // Renders the Role selection dropdown (Step 2)
        const renderRoleSelector = () => {
            const card = document.getElementById('role-selection-card');
            const content = document.getElementById('role-selector-content');
            
            if (!selectedIndustryId) {
                card.classList.add('hidden');
                return;
            }

            card.classList.remove('hidden');

            const rolesMap = TRAINING_DATA[selectedIndustryId] || {};
            const allRoles = Object.keys(rolesMap);
            const otherRole = 'Other (Request OHS Advice)';

            // Sort regular roles alphabetically and append 'Other'
            const regularRoles = allRoles.filter(role => role !== otherRole).sort();
            const availableRoles = allRoles.includes(otherRole) ? [...regularRoles, otherRole] : regularRoles;

            let optionsHtml = `<option value="" disabled selected>${availableRoles.length > 0 ? 'Choose your specific role...' : 'Select an Industry first...'}</option>`;
            
            availableRoles.forEach(role => {
                const isSelected = selectedRole === role;
                optionsHtml += `<option value="${role}" ${isSelected ? 'selected' : ''}>${role}</option>`;
            });

            content.innerHTML = `
                <div class="space-y-4">
                    <label for="role-select" class="block text-lg font-medium text-gray-700">
                        2. Select Your Job Role:
                    </label>
                    <div class="relative">
                        <select
                            id="role-select"
                            onchange="handleRoleChange(this.value)"
                            class="w-full pl-4 pr-10 py-3 text-lg border border-gray-300 rounded-xl appearance-none focus:outline-none focus:ring-actsafe-yellow focus:border-actsafe-yellow cursor-pointer transition duration-150 ease-in-out shadow-md"
                        >
                            ${optionsHtml}
                        </select>
                        <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
                            ${getIconSvg('ChevronDown', 'w-5 h-5')}
                        </div>
                    </div>
                </div>
            `;
        };

        // Renders the final training checklist (Step 3)
        const renderTrainingChecklist = () => {
            const card = document.getElementById('results-display-card');
            const content = document.getElementById('training-checklist-content');
            
            if (!selectedRole || !selectedIndustryId) {
                card.classList.add('hidden');
                return;
            }

            const trainingChecklist = TRAINING_DATA[selectedIndustryId]?.[selectedRole] || [];
            
            if (trainingChecklist.length === 0) {
                card.classList.add('hidden');
                return;
            }

            card.classList.remove('hidden');

            const mandatoryTraining = trainingChecklist.filter(t => t.type === 'Mandatory');
            const recommendedTraining = trainingChecklist.filter(t => t.type === 'Recommended');

            const renderTrainingCard = (training) => {
                const isMandatory = training.type === 'Mandatory';
                const iconName = isMandatory ? 'AlertTriangle' : 'CheckCircle';
                const colorClass = isMandatory ? 'bg-red-50 border-red-300 text-red-700' : 'bg-green-50 border-green-300 text-green-700';
                const iconColorClass = isMandatory ? 'text-red-500' : 'text-green-500';
                const typeTextClass = isMandatory ? 'text-red-600' : 'text-green-600';
                const typeLabel = isMandatory ? 'MANDATORY' : 'RECOMMENDED';

                return `
                    <div class="p-4 border rounded-xl shadow-sm flex items-start space-x-4 transition transform hover:scale-[1.02] ${colorClass}">
                        <div class="flex-shrink-0 mt-1">
                            ${getIconSvg(iconName, `w-6 h-6 ${iconColorClass}`)}
                        </div>
                        <div class="flex-grow">
                            <p class="font-semibold text-lg">${training.name}</p>
                            <p class="text-sm font-medium ${typeTextClass} mb-2">
                                ${typeLabel}
                            </Lg>
                            <a 
                                href="${training.link}" 
                                target="_blank" 
                                rel="noopener noreferrer"
                                class="inline-flex items-center text-actsafe-blue hover:text-actsafe-yellow-dark text-sm font-bold transition duration-150 underline"
                            >
                                View Course Details & Register &rarr;
                            </a>
                        </div>
                    </div>
                `;
            };

            let html = '';

            // Mandatory Section
            if (mandatoryTraining.length > 0) {
                html += `
                    <div class="mb-8 p-4 border-l-4 border-red-500 bg-red-50 rounded-lg">
                        <h3 class="text-xl font-semibold text-red-700 mb-3 flex items-center">
                            ${getIconSvg('AlertTriangle', 'w-5 h-5 mr-2')} Mandatory Training
                        </h3>
                        <p class="text-sm text-red-600 mb-4">
                            These courses are generally required by industry regulations or union agreements for your role.
                        </p>
                        <div class="space-y-3">
                            ${mandatoryTraining.map(renderTrainingCard).join('')}
                        </div>
                    </div>
                `;
            }

            // Recommended Section
            if (recommendedTraining.length > 0) {
                html += `
                    <div class="p-4 border-l-4 border-green-500 bg-green-50 rounded-lg">
                        <h3 class="text-xl font-semibold text-green-700 mb-3 flex items-center">
                            ${getIconSvg('CheckCircle', 'w-5 h-5 mr-2')} Recommended Training
                        </h3>
                        <p class="text-sm text-green-600 mb-4">
                            These courses will enhance your skills and safety knowledge, improving job site compliance.
                        </This>
                        <div class="space-y-3">
                            ${recommendedTraining.map(renderTrainingCard).join('')}
                        </div>
                    </div>
                `;
            }

            content.innerHTML = html;
        };
        
        // Updates visibility of the initial prompt
        const updateVisibility = () => {
            const initialPrompt = document.getElementById('initial-prompt');
            if (selectedIndustryId) {
                initialPrompt.classList.add('hidden');
            } else {
                initialPrompt.classList.remove('hidden');
            }
        };


        // --- EVENT HANDLERS / STATE UPDATERS ---

        const handleIndustryChange = (industryId) => {
            if (selectedIndustryId === industryId) {
                // Deselect if clicking the current one
                selectedIndustryId = null;
                selectedRole = null;
            } else {
                selectedIndustryId = industryId;
                // Reset role when industry changes
                selectedRole = null; 
            }
            
            // Re-render all elements
            renderIndustrySelectors();
            renderRoleSelector();
            renderTrainingChecklist();
            updateVisibility();
        };

        const handleRoleChange = (role) => {
            selectedRole = role;
            
            // Re-render training results
            renderTrainingChecklist();
        };

        // --- INITIALIZATION ---
        const initApp = () => {
            renderIndustrySelectors();
            renderRoleSelector();
            renderTrainingChecklist();
            updateVisibility();
        };

        // Start the application once the DOM is fully loaded
        window.onload = initApp;

    </script>
</body>
</html>
